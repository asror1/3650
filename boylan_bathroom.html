<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="globals.css" />
    <link rel="stylesheet" href="reviews.css" />
    <title>Boylan 2143 Bathroom</title>

    <script>
      document.addEventListener('DOMContentLoaded', function () {
        const leaveReviewButton = document.querySelector('button');
        leaveReviewButton.addEventListener('click', function () {
          const reviewerName = document.getElementById('reviewer_name').value || 'Anon';
          const reviewerRating = parseInt(document.getElementById('reviewer_rating').value, 10);
          const reviewerComment = document.getElementById('reviwer_comment').value;

          if (isNaN(reviewerRating) || reviewerName === '' || reviewerComment === '') {
            alert('Please provide a valid rating and do not leave any inputs blank before adding a review');
            return;
          }

          const newReviewDiv = document.createElement('div');
          newReviewDiv.classList.add('review');

          newReviewDiv.innerHTML = `
            <h2>${reviewerName}</h2>
            <h4>${reviewerRating}/5</h4>
            <p>${reviewerComment}</p>
          `;

          const lastHrElement = document.querySelector('.reviews hr:last-of-type');
          lastHrElement.insertAdjacentElement('afterend', newReviewDiv);

          updateOverallRating();
          
          document.getElementById('reviewer_name').value = '';
          document.getElementById('reviewer_rating').value = '';
          document.getElementById('reviwer_comment').value = '';
        });

        function updateOverallRating() {
          const reviewElements = document.querySelectorAll('.review');

          let totalRating = 0;
          let numberOfReviews = reviewElements.length;

          reviewElements.forEach(function (reviewElement) {
            const rating = parseInt(reviewElement.querySelector('h4').textContent, 10);
            totalRating += rating;
          });

          const averageRating = numberOfReviews > 0 ? totalRating / numberOfReviews : 0;

          const overallRatingElement = document.querySelector('.info h1');
          overallRatingElement.textContent = `${averageRating.toFixed(1)}/5 Stars`;
        }
      });
    </script>
  </head>

  <body>
    <nav>
      <a href="index.html">
        <h1>Find My Bathroom</h1>
        <img src="logo.svg" alt="logo" />
      </a>
    </nav>
    <main>
      <div class="info">
        <h2>Boylan Room 2143</h2>
        <h1>3/5 Stars</h1>
      </div>
      <div class="carousel">
        <div class="leftArrow"></div>
        <div class="images">
          <img src="bathroom1.jpeg" alt="bathroom image 1" />
          <img src="bathroom2.jpg" alt="bathroom image 2" />
          <img src="bathroom3.webp" alt="bathroom image 3" />
          <img src="bathroom4.jpg" alt="bathroom image 4" />
          <img src="bathroom5.jpg" alt="bathroom image 5" />
        </div>
        <div class="rightArrow"></div>
      </div>
      <div class="reviews">
        <div class="reviewInput">
          <span class="r1">
            <span>
              <label for="reviewer_name" class="space">Name:</label>
              <input
                type="text"
                placeholder='Defaults to "Anon"'
                name="reviewer_name"
                id="reviewer_name"
              />
            </span>
            <span>
              <label for="reviewer_rating" class="space">Rating:</label>
              <input
                type="number"
                name="reviewer_rating"
                id="reviewer_rating"
                min="0"
                max="5"
                value="0"
              />
            </span>
            <button>Leave Review</button>
          </span>
          <div class="comment">
            <label for="reviewer_comment">Comment:</label>
            <textarea id="reviwer_comment" cols="30" rows="10"></textarea>
          </div>
        </div>
        <hr>
        <div class="review">
          <h2>Randy Reviewer</h2>
          <h4>3/5</h4>
          <p>
            Consectetur doloremque inventore ipsa nemo exercitationem! Nihil
            deserunt velit neque iusto magnam. Minima enim minima ab aliquid
            voluptatem? Nesciunt quisquam nulla mollitia in quibusdam placeat?
          </p>
        </div>
        <div class="review">
          <h2>Anon</h2>
          <h4>3/5</h4>
          <p>
            Elit amet neque sed consequuntur eaque ex. Tempore fugiat harum
            repudiandae officia libero in pariatur expedita? Ipsum delectus
            ducimus omnis ab enim iure exercitationem Fugiat quidem nisi
            voluptatibus doloremque ad. Consectetur veniam inventore accusantium
            voluptate amet tenetur? Quae voluptatibus numquam voluptas ullam
            quis Dolore eaque in quae ducimus ipsa debitis
          </p>
        </div>
      </div>
    </main>
  </body>
</html>
